# Uncomment to enable openstack provider
#---
#diskimages:
#  - name: dib-centos-7
#    elements:
#      - centos-minimal
#      - nodepool-minimal
#      - zuul-worker-user
#
#labels:
#  - name: dib-centos-7
#    min-ready: 1
#
#providers:
#  - name: default
#    cloud: default
#    clean-floating-ips: true
#    image-name-format: '{image_name}-{timestamp}'
#    boot-timeout: 120
#    rate: 10.0
#    diskimages:
#      - name: dib-centos-7
#    pools:
#      - name: main
#        max-servers: 5
#        networks:
#          - slave-net-name
#        labels:
#          - name: dib-centos-7
#            min-ram: 1024
#            diskimage: dib-centos-7
diskimages:
  - name: debian-9-image
    username: zuul-worker
    elements:
      # This is a fake element to reference the playbook
      - debian-9-cloud
    env-vars:
      PATH: /etc/nodepool/elements/virt-customize:/bin:/sbin:/usr/bin:/usr/sbin
    formats:
      - qcow2

providers:
  - name: openstack
    cloud: openstack
    clean-floating-ips: true
    image-name-format: '{image_name}-{timestamp}'
    boot-timeout: 120
    rate: 10.0
    pools:
      - name: main
        max-servers: 2       
        networks:
          - zuul-net
        labels:
          - name: debian9-vm
            flavor-name: m1.small
            diskimage: debian-9-image

labels:
  - name: debian9-vm
    min-ready: 1

extra-labels:
  - provider: openstack
    pool: main
    diskimages:
      - name: debian-9-image
    #cloud-images:
    #  - name: debian9
    #    image-id: 2f7a3f33-34b2-4278-a914-bb4ce8f461a3
    #    username: debian
    labels:
      - name: debian9-vm
  
